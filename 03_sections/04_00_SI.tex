%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%`
%% Supporting Information
%% TODO:
%%    TODO: Free energy corrections to OER intermediates, OER mechanism
%%    TODO: Is there any cross-validation happening here? I don't think so
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% #########################################################
\section{Active Learning ML Section}  % ###################
% #########################################################
%
% #########################################################
% | - Active Learning ML Section

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Candidate space generation}  % %%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - Candidate space generation


% ################################# Paragraph #############
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Basic intro into candidate generation
% High-level overview again
%   * Data mining OQMD MP fro AB2/3 entries
%   * Reduce data set by eliminating structurally redundant systems
%     * This is done with Ankit's scheme
%   *
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - Paragraph start
%
Here we describe the methodology to construct the set of structural candidates in more detail. The first step of the procedure is to mine materials databases for entries with the desired non-element specific stoichiometry (\latin{i.e.} \ABtwo and \ABthree). Since many of the entries in these databases are structurally redundant, we used a structure classification scheme to reduce the data set to a structurally unique set. Once this is accomplished, the elements of interest were then substituted into the database structures, which at this point had their original elemental composition from their database. Finally, the structures are isotropically expanded or contracted to accommodate the difference between the atomic radii of the original elements in the structure and the user defined elements.
% __|


% ################################# Paragraph #############
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Data-mining OQMD and MP
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - Paragraph start
%Herein, we take advantage of the structural diversity already present in materials databases to construct our candidates.
%
We utilized two materials databases, the Open Quantum Materials (OQMD) and the Materials Project (MP) databases because of their large and diverse datasets of crystalline inorganic materials.
%
% TODO Approx. when did Ankit parse these databases
At the time that we originally mined these databases (2018), there were \num{61471} inorganic compounds in the MP database and \num{435583} entries in the OQMD database. We note that the databases have expanded the number of entries considerably since we originally parsed them, although the number of unique crystal polymorphs is not expected to have increase significantly.

%
The structural classification scheme of Jain \latin{et al.} was used to classify the structure and element-nonspecific stoichiometry of each structure (\num{497054} in total). This structural classification scheme can directly serve as a structural fingerprint and has successfully been applied towards the prediction of formation energies of inorganic compounds \cite{Jain2018}.
%
% COMBAK Revise if Ankit's scheme becomes it's own section
% If it's not ready now, let's not include it.
%See section TEMP for more details on the symmetry based structural classification scheme.
%
Once classified, we selected all entries with the desired stoichiometry of \ABtwo and \ABthree,
for which MP has \num{2424} and \num{2341} \ABtwo and \ABthree entries, respectively,
and OQMD has \num{4736} and \num{28,883} \ABtwo and \ABthree entries, respectively.

The reason that there are considerably more \ABthree compounds in OQMD is due to the extensive compositional permutation of the binary alloys in a cubic  \ABthree structure.


%The reason that there are considerably more \ABthree compounds in OQMD is due to the extensive compositional permutation of the cubic Perovskite structure (ABO\textsubscript{3} ABO3) with the A cation removed.


Within each stoichiometry, the structural classification was used to eliminate structurally redundant systems, \latin{i.e.} systems that share their stoichiometry, space-group, and Wyckoff positions. This process reduces the data set to \num{620} and \num{219} unique structures of \ABtwo and \ABthree for MP and \num{397} and \num{194} structurally unique \ABtwo and \ABthree OQMD entries.
%
% COMBAK
Combining the MP and OQMD data sets ultimately results in a dataset of \num{688} \ABtwo and \num{254} \ABthree structurally unique candidates.
%
% __|



% | - Table of OQMD MP Structures
\begin{table}[!htb]

  \caption{\label{table:database_structures}
    %
    (a) Number of entries in the OQMD and MP materials databases for the \ABtwo and \ABthree stoichiometries.
    %
    (b) Final number of unique structural candidates for \ABtwo and \ABthree.
    }
  %
  % | - Subtable a
  \begin{subtable}{.5\linewidth}
  \centering
  \caption{}
  %
   %
    %
    \begin{tabular}{cccc}
    \textbf{}         & \textbf{}        & \multicolumn{2}{c}{\textbf{Entries}} \\
    \textbf{Database} & \textbf{Stoich.} & \textbf{Total}   & \textbf{Unique}   \\
    OQMD              &                  & 61,471           &                   \\
                      & \ABtwo           & 4,736            & 397               \\
                      & \ABthree         & 28,883           & 194               \\
    \hline
    MP                &                  & 435,583          &                   \\
                      & \ABtwo           & 2,424            & 620               \\
                      & \ABthree         & 2,341            & 219
    \end{tabular}
    %
   %
  %
  \end{subtable}
  % __|
  %
  %
  \newline
  \vspace*{0.8 cm}
  \newline
  %
  %
  % | - Subtable b
  \begin{subtable}{.5\linewidth}
  \centering
  \caption{}
  %
   %
    %
    \begin{tabular}{cc}
    \multicolumn{2}{c}{\textbf{Final Candidate Set}} \\
    \textbf{Stoich.}   & \textbf{Unique Structures}  \\
    \ABtwo             & 688                         \\
    \ABthree           & 254
    \end{tabular}
    %
   %
  %
  \end{subtable}
  % __|
  %
\end{table}
% __|


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Structure featurization and data processing}  %
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - Structure featurization and data processing


Structures are featurized using the Voronoi tessellation method developed by Ward et al. \cite{Ward2017}. Zero-variance features that don't encode for any information within a set of structures with constant composition and stoichiometry are removed before model training, reducing the number of feature columns from \num{271} to \num{101}. 

The number of features are further reduced to TEMP by performing a principal component analysis (PCA), using only post-relaxation fingerprints training and testing, the result shown in Figure \ref{fig:cv_anal}.

% TODO Add all of the feature engineering steps here
% __|

% =========================================================
% FIGURE ==================================================
% | - Figure | Cross-validation analysis ******************
\begin{figure*}[!htb]
\centering
\makebox[\textwidth][c]{\includegraphics
  {02_figures/SI_figures/00_mae_pca_plot__v0__1500dpi.png}
  }
\caption{\label{fig:cv_anal}
20-fold cross validation mean absolute error (MAE) as a function of the number of PCA components used for the GP-regression for \IrOthree. Only post-relaxation fingerprints were used for both training and testing to avoid issues with structural drift. All structural duplicates in the post-relaxation dataset were removed.
}
\end{figure*}
% __|
% =========================================================

% __|


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Gaussian process regression model}  % %%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Relevant details about the ML Gaussian process here  % @Chris
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - Gaussian process regression model
%
The Gaussian Process model utilized two isotropic Gaussian (RBF) kernels, with one kernel having a larger length scale parameter than the other.

RAUL - PLEASE EDIT! "What are the length scale hyperparameters (width parameter in CatLearn)? and what is noise and alpha in the table? They should be part of the kernel expression."

\begin{equation}
    k(x,x') = \sigma_1^ 2 e^{\frac{-|x-x'|^2}{2l_1^2}} + \sigma_2^ 2 e^{\frac{-|x-x'|^2}{2l_2^2}} + NOISE-kernel?
\end{equation}

%
% TODO Double check that I said it correctly, might be minimizing the LML
The hyperparameters of the GP kernels are optimized every time the GP is trained such that the log marginal likelihood of the model and training data is maximized.
%
The initial values of the hyper parameters are as follows:

% | - Table of GP Hyper parameters

\begin{table}[htbp]
\centering
\begin{tabular}{cc}
  GP Hyper Paramter & Initial Value \\
  noise & 0.02542 \\
  sigmaL & 1.0049 \\
  sigmaF & 5.19 \\
  alpha & 0.018
\end{tabular}
\end{table}
% __|

% __|


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Bulk polymorph DFT optimization}  % %%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%

All DFT calculations were performed using density functional theory (DFT) implemented via the Vienna \latin{ab-initio} simulation package (VASP) \cite{Kresse1995,Kresse1996_0,Kresse1996_1} and utilizing the PBE exchange-correlation functional\cite{Perdew1996}. A cutoff plane-wave cutoff of 600 eV was used, and calculations were spin-polarized. A variable k-point mesh was used such that a k-point density of at least \num{20} k-points per reciprocal space dimension. 
%
All bulk systems were run through the following computational recipe to converge the equilibrium structure, with \num{3} distinct phases. structures are only advanced to the next phase when the previous phase completes without error.
\\
1. An ISIF \num{7} calculation to optimize only the volume (initial volume of cell may be really off).
\\
2. Three consecutive ISIF \num{3} relaxations to fully converge the lattice and atomic positions.
\\
3. A final ISIF \num{2} calculation to relax the atomic coordinates only to avoid errors associated with changing the cell volume with a fixed plane-wave cutoff basis.
\\
The final ISIF \num{2} step is run with an electronic energy SCF convergence criteria of \SI{1e-6} eV and the ionic relaxation has a tight force convergence criteria of \SI{1e-3}{\electronvolt\per\angstrom}.


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\IrOtwo Active Learning Results} %
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Here are the analogous IrO2 results that were presented for IrO3 in the main text
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - TEMP
%
TEMP section about IrO2 active learning results.
% __|

% =========================================================
% FIGURE ==================================================
% =========================================================
% | - Figure | IrO3 Convergence Plot
\begin{figure*}[!htb]
\centering
\makebox[\textwidth][c]{\includegraphics{02_figures/SI_figures/00_ml_plot_iro2_al__v5__downsampled_0800x0800.pdf}}
\caption{\label{fig:iro2_al}
Active learning iteration for the IrO2 polymorphs. Several of the most stable phase, including rutile and pyrite, are discovered after only 5 active-learning iterations and 30 DFT calculations.
}
\end{figure*}
% __| =====================================================
% =========================================================



% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Structural coordination motif identification} %
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - Structural coordination motif identification

Several esoteric structural features were found in the DFT optimized structures and can be categorized as one of two types,
legitimate structural motifs not characterized by the scheme of Waroquiers et. al. \cite{Waroquiers2017}, and arguably non-physical structural artifacts, including:
% TODO Add more of these
- unassociated oxygen atoms
- molecular oxygens in the unit cell
% __|

% __|


% #########################################################
\section{Electrochemical OER Computational Methods}  % ####
% #########################################################
%
% #########################################################
% | - Electrochemical OER Computational Methods


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Density Functional Theory Methods}  % %%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - Density Functional Theory Methods
%
All OER calculations were performed using density functional theory (DFT) implemented via the Vienna \latin{ab-initio} simulation package (VASP)
\cite{Kresse1995,Kresse1996_0,Kresse1996_1}
and utilizing the PBE exchange-correlation functional\cite{Perdew1996}.
%
Dipole corrections were imposed on all non-symmetric slabs to counteract spurious dipole interactions between the periodic cells.\cite{Neugebauer1992}
%
% TODO COMBAK, make this section more general, k-points were treated differently
% for different calculations
A 4x4x3 k-point mesh with gamma-point centered Monkshort-packing\cite{Monkhorst1976} was used for all slabs.
%
The plane-wave energy cutoff was \SI{500}{\electronvolt}.
%
% COMBAK Figure out how much spacing was used for all slabs
All slab calculations maintained a vacuum spacing in between TEMP and \SI{15}{\angstrom}
%
All structures were relaxed with utilizing the conjugate gradient algorithm as implemented in VASP (IBRION\num{=2}).
%
The simulation stop criteria used was that all atoms must satisfy a maximum force threshold of \SI{0.02}{\electronvolt\per\angstrom}.
% __|


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Bulk Pourbaix Diagram}  % %%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - Bulk Pourbaix Diagram
The electrochemical bulk Pourbaix diagrams were constructed using the TEMP module from pymatgen.

% | - Figure | OER Scaling Relations
\begin{figure*}[!htb]
\centering
\makebox[\textwidth][c]{\includegraphics{02_figures/SI_figures/bulk_pourbaix_wo_alpha.pdf}}
\caption{\label{fig:bulk_pourbaix_wo_alpha}
TEMP CAPTION
}
\end{figure*}
% __|

% __|


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{OER Thermodynamic Methodology}  % %%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - OER Thermodynamic Methodology
%
Here we will outline the procedure used to carry out OER simulations on the various slabs of \IrOtwo and \IrOthree.
%
The procedure was as follows:
%
Stable stoichiometric terminations were cut from the bulk. The stable termination planes were via the x-ray diffraction pattern tool from Vesta and intuition.
%
Next, electrochemical surface coverage was elucidated via a surface Pourbaix analysis. This elucidates the coverage under operating conditions ($>$ \SI{1.23}{\volt{} vs. RHE}) for each slab.
%
% COMBAK
Finally we conducted a thermodynamic/limiting potential analysis of the OER mechanistic pathway (Volcano plot, limiting potentials, etc.).
% __|


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Surface Energy Pourbaix Methodology}  % %%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - Surface Energy Pourbaix Methodology
%
Surface energy Pourbaix plots were constructed by calculating the surface energy of each slab by under standard conditions (\si{\volt}\num{=0} and pH\num{=0}) and then utilizing the computational hydrogen electrode (CHE) to compute the potential dependence of the surfaces.
%
Surface energy calculations were performed for various facets for slabs of increasing thickness.
%
% TODO Insert reference for surface E calcs
The bulk energy was then extracted by fitting the total energy of the slabs against the number of layers as explained in TEMP.
%
This was  done to avoid common issues of surface energy divergence associated with using a separate bulk energy calculation.
%
The sensitivity of a given slab to an applied bias is dependent on the composition of the surface,
in particular, the effect of coverage of electrolyte species which can deposit oxygen, hydrogen, and hydroxide species on the surface layers.
%
These additional \ce{O} and \ce{H} atoms are not referenced to the atoms in the slab, but are instead referenced to the computational hydrogen electrode and water-splitting reaction.
%
% TODO Type out equations for surface energy calculation
The equation for is as follows:
% __|


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{OER Scaling Relations}  % %%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - OER Scaling Relations

% ################################# Paragraph #############
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Figure~\ref{fig:scaling_relations} shows the scaling relations between the adsorption free energies of the OER intermediate species for the studied \IrOx slabs.
%
It can be seen clearly that the data points corresponding to the three \IrOthree polymorphs are roughly \SI{1}{\electronvolt} weaker binding than the \rIrOtwo points.
%
This generally weaker binding of the \IrOthree stoichiometry is responsible for the observed improvement in theoretical activity.
%
The \DGOOH vs.\DGOH relationship is very close to the traditional ``universal scaling relations'', demonstrating that our materials do not break the infamous \DGOOH vs. \DGOH scaling.


% | - Figure | OER Scaling Relations
\begin{figure*}[!htb]
\centering
% \makebox[\textwidth][c]{\includegraphics{02_figures/oer_activity_stability/00_master__oer_scaling__main_v0__outplot2.png}}
\makebox[\textwidth][c]{\includegraphics{02_figures/oer_activity_stability/oer_scaling.pdf}}
\caption{\label{fig:scaling_relations}
Relationship between the adsorption free energies of the three key OER intermediates (*OH, *O, *OOH), with \DGOH chosen as the dependent variable.
%
Best fit lines are provided for \DGOOH vs. \DGOH and \DGO vs. \DGOH.
%
Additionally, ``universal scaling relations'' for \DGOOH vs. \DGOH and \DGO vs. \DGOH are shown (black dotted lines) to emphasize our deviation from the traditionally reported scaling fits.
%
The \DGOH line is  shown as guide to eye.
% TODO Do I have to redefine the color convention every caption?
}
\end{figure*}
% __|

% __|


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Bulk Systems}  % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - Bulk Systems
% Formation energies of 4 polymorphs

% __|


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Table of OER energetics}  % %%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% | - Table of OER energetics
%
Table \ref{table:oer_data} contains the adsorbate binding energetics for the intermediates of the OER
oxygen evolution reaction (*O, *OOH, *OH).


\newpage  % request a new page.
\begin{landscape}
\renewcommand{\arraystretch}{1.5} % <--------------
\begin{table}
\resizebox{\linewidth}{!}{%
\centering
\caption{\label{table:oer_data}
%
OER adsorbation energies for slabs of \IrOtwo and \IrOthree polymorphs studied here.
%
Included quantities are electronic adsorption energies
($\Delta E_{*O_{x}H_{y}}$),
adsorption free energies
($\Delta G_{*O_{x}H_{y}}$),
as well as the \DGOmOH OER descriptor.
%
Coverage indicates the electrochemical coverage of either *O or *OH species.
%
The limiting potential and corresponding overpotential ($\eta$) as well as the rate determining step (RDS) for the OER mechanism are shown.
}
\input{04_data_tables/oer_energetics/oer_table.tex}
}
\end{table}

\end{landscape}
% __|

% __|
